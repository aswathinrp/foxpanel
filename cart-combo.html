<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Combo 10+1 Cart | FoxPanel</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<style>
  :root{ --brand:#ff7b00; }
  body{ background:#f6f8fa; }
  .topbar{ background:#111; color:#fff; }
  .btn-brand{ background:var(--brand); color:#fff; border:0; }
  .btn-brand:hover{ background:#e26f00; color:#fff; }
  .cart-thumb{
    width:84px; height:84px; object-fit:cover;
    border-radius:.5rem; border:1px solid rgba(0,0,0,.08);
  }
  .card-row{
    background:#fff; border-radius:.75rem; border:1px solid rgba(0,0,0,.08);
    padding:.75rem .9rem;
  }
</style>
</head>
<body>

<header class="topbar">
  <div class="container py-2 d-flex justify-content-between align-items-center">
    <strong>Fox Panel</strong>
    <div class="d-flex gap-2">
      <a class="btn btn-sm btn-outline-light" href="category-foxpanel.html">Back</a>
    </div>
  </div>
</header>

<main class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="m-0">Combo 10+1 â€” Cart</h4>
    <div>
      <button id="clearCart" class="btn btn-outline-danger me-2"><i class="bi bi-trash"></i> Clear</button>
      <button id="confirmPay" class="btn btn-brand"><i class="bi bi-credit-card"></i> Confirm &amp; Pay</button>
    </div>
  </div>

  <div id="list" class="vstack gap-3 mb-3"></div>

  <div id="empty" class="text-center text-muted py-5 d-none">
    Nothing here yet. <a href="category-foxpanel.html">Go back</a> to add your photos.
  </div>

  <div class="d-flex justify-content-between align-items-center">
    <div class="small text-muted"><span id="count">0</span>/11 item(s)</div>
    <div class="fs-5 fw-bold">Total: AED <span id="total">100</span></div>
  </div>
</main>

<script>
const listEl   = document.getElementById('list');
const emptyEl  = document.getElementById('empty');
const countEl  = document.getElementById('count');
const totalEl  = document.getElementById('total');

let items = [];
let total = 100; // fixed price for Combo 10+1

function load(){
  try{
    items = JSON.parse(sessionStorage.getItem('comboCart') || '[]');
    total = parseFloat(sessionStorage.getItem('comboTotal') || '100');
  }catch(e){ items = []; total = 100; }
  render();
}

function save(){
  sessionStorage.setItem('comboCart', JSON.stringify(items));
  sessionStorage.setItem('comboTotal', String(total));
  render();
}

function removeAt(idx){
  items.splice(idx,1);
  save();
}

function clearAll(){
  items = [];
  save();
}

function render(){
  listEl.innerHTML = '';
  countEl.textContent = items.length;
  totalEl.textContent = total.toFixed(0);

  if (!items.length){
    emptyEl.classList.remove('d-none');
    return;
  }
  emptyEl.classList.add('d-none');

  items.forEach((it, i)=>{
    const row = document.createElement('div');
    row.className = 'card-row d-flex align-items-center justify-content-between';

    const left = document.createElement('div');
    left.className = 'd-flex align-items-center gap-3';

    const img = new Image();
    img.src = it.dataUrl;
    img.className = 'cart-thumb';

    const meta = document.createElement('div');
    meta.innerHTML = `
      <div class="fw-semibold small">${it.name}</div>
      <div>
        <span class="badge text-bg-light">#${String(it.idx).padStart(2,'0')}</span>
        <span class="badge text-bg-light">${it.size}</span>
      </div>
    `;

    left.append(img, meta);

    const rm = document.createElement('button');
    rm.className = 'btn btn-sm btn-outline-danger';
    rm.innerHTML = '<i class="bi bi-x"></i>';
    rm.title = 'Remove';
    rm.onclick = ()=> removeAt(i);

    row.append(left, rm);
    listEl.appendChild(row);
  });
}

document.getElementById('clearCart').addEventListener('click', ()=>{
  if (confirm('Clear the combo cart?')) clearAll();
});

document.getElementById('confirmPay').addEventListener('click', ()=>{
  if (!items.length){ alert('Your cart is empty.'); return; }
  if (confirm(`Pay AED ${total.toFixed(0)} for Combo 10+1 with ${items.length} photo(s)?`)){
    // TODO: POST "items" to your backend here.
    alert('Payment successful (demo). Order placed!');
    clearAll();
    // optional redirect:
    // location.href = 'thank-you.html';
  }
});

load();
</script>
</body>
</html>
